{% extends "base.html" %}
{% load static %}

{% block title %}Travel Your Way | Aorbo Treks{% endblock %}

{% block content %}

<!-- ================= PAGE HEADER ================= -->
<section class="travel-header">
    <div class="container travel-container">

        <a href="{% url 'home' %}" class="back-link">
            ‚Üê Back to Home
        </a>

        <h1 class="travel-title">
            Travel Your Way
            <span class="tag-pill">{{ selected_tag|title }}</span>
        </h1>

        <p class="travel-subtitle">
            Showing treks and trips that match your travel style.
        </p>

    </div>
</section>

<!-- ================= TREKS ================= -->
<section class="trek-listing">
    <div class="container travel-container">
        <div class="row g-3">

            {% for trek in treks %}
            <div class="col-12 col-sm-6 col-md-4 col-lg-3 d-flex">

                <a href="{% url 'card_trek_detail' trek.id %}"
                   class="premium-card h-100 w-100 text-decoration-none text-dark d-flex flex-column">

                    <!-- IMAGE -->
                    <div class="trek-card-image-wrapper ratio ratio-4x3">
                        <div class="image-inner">

                            {% with trek.images.first as img %}
                                {% if img and img.image_url %}
                                    <img src="{{ img.image_url }}" alt="{{ trek.name }}" loading="lazy">
                                {% else %}
                                    <img src="{% static 'images/placeholder-trek.jpg' %}" alt="{{ trek.name }}">
                                {% endif %}
                            {% endwith %}

                            <div class="price-pill">
                                <span class="price-onwards">Onwards*</span>
                                <span class="price-value">‚Çπ{{ trek.price_start }}</span>
                            </div>

                        </div>
                    </div>

                    <!-- CONTENT -->
                    <div class="card-content p-3">

                        <h5 class="fw-bold mb-1">{{ trek.name|title }}</h5>

                        <p class="small mb-2 location-text">
                            üìç {{ trek.state }}
                        </p>

                        <p class="small mb-1 days">
                            <strong>Duration:</strong> {{ trek.duration_days }}
                        </p>

                        <p class="small mb-2 days">
                            <strong>Departure:</strong> {{ trek.operating_days|upper }}
                        </p>

                        {% if trek.operators.exists %}
                        <div class="operator-grid-wrapper mt-auto pt-2 border-top">
                            <div class="d-flex justify-content-center">
                                {% for operator in trek.operators.all|slice:":3" %}
                                    <span class="operator-badge-premium">{{ operator }}</span>
                                {% endfor %}
                                {% if trek.operators.count > 3 %}
                                    <span class="operator-badge-premium">
                                        +{{ trek.operators.count|add:"-3" }}
                                    </span>
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}

                    </div>

                </a>

            </div>
            {% endfor %}

        </div>
    </div>
</section>

{% endblock %}

{% block extra_css %}
<style>

/* ================= HEADER ================= */
.travel-header {
    padding-top: clamp(6rem, 15vw, 7.5rem);
    padding-bottom: 3rem;
    background: #f8fafc;
    border-bottom: 1px solid #e5e7eb;
}

.back-link {
    font-weight: 600;
    color: #2563eb;
    text-decoration: none;
}

.travel-title {
    font-size: clamp(2.4rem, 4vw, 3.4rem);
    font-weight: 800;
    color: #111827;
    display: flex;
    align-items: flex-start; /* üîë */
    gap: 1.25rem;
    line-height: 1.1;
}

.tag-pill {
    background: linear-gradient(135deg, #ff7a18, #ff3d00);
    color: #fff;
    padding: 10px 22px;
    border-radius: 999px;
    font-size: 0.85rem;
    font-weight: 700;
    white-space: nowrap;
    margin-top: 0.45rem; /* üî• visually aligns with heading */
}

.travel-subtitle {
    color: #4b5563;
    max-width: 640px;
}

/* ================= LISTING ================= */
.trek-listing {
    background: #f1f6f7;
    padding: 3.5rem 0 4.5rem;
}

/* ================= PREMIUM CARD ================= */
.premium-card {
    background: #ffffff;
    border-radius: 16px;
    border: 1px solid #e5e7eb;
    overflow: hidden; /* üîë VERY IMPORTANT */
    transition: transform .3s ease, box-shadow .3s ease;
}

.premium-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 20px 40px rgba(0,0,0,.12);
}

/* ================= IMAGE ================= */
.trek-card-image-wrapper {
    position: relative;
    overflow: hidden;
    border-top-left-radius: 16px;
    border-top-right-radius: 16px;
}

.image-inner {
    position: absolute;
    inset: 0;
    overflow: hidden;
    border-top-left-radius: 16px;
    border-top-right-radius: 16px;
}

.image-inner img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    transition: transform .5s ease;
}

.premium-card:hover img {
    transform: scale(1.08);
}

/* ================= PRICE PILL (WITH ANIMATION) ================= */
.price-pill {
    position: absolute;
    bottom: 16px;
    right: 16px;
    background: linear-gradient(135deg, #ff7a18, #ff3d00);
    color: #fff;
    padding: 8px 14px;
    border-radius: 40px;
    box-shadow: 0 6px 16px rgba(0,0,0,.35);
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 2px;
    animation: floatPrice 3s ease-in-out infinite;
}

.price-onwards {
    font-size: 0.5rem;
    font-weight: 600;
    letter-spacing: 0.05em;
    opacity: 0.9;
}

.price-value {
    font-size: 0.95rem;
    font-weight: 800;
    line-height: 1;
}

/* FLOATING EFFECT (FROM index.html) */
@keyframes floatPrice {
    0%, 100% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-6px);
    }
}

/* ================= TEXT ================= */
.location-text {
    color: #4b5563;
    font-weight: 500;
}

.days {
    font-size: 13px;
    color: #374151;
}

/* ================= OPERATORS ================= */
.operator-grid-wrapper .d-flex {
    flex-wrap: wrap;
    gap: 6px;
}

.operator-badge-premium {
    background-color: #f97316;
    color: #ffffff;
    font-size: 0.7rem;
    font-weight: 600;
    padding: 5px 12px;
    border-radius: 16px;
    transition: background-color 0.2s ease;
}

.operator-badge-premium:hover {
    background-color: #ea580c;
}


</style>
{% endblock %}
