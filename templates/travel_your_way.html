{% extends "base.html" %}
{% load static %}

{% block title %}Travel Your Way | Aorbo Treks{% endblock %}

{% block content %}

<!-- ================= PAGE HEADER ================= -->
<section class="travel-header">
    <div class="container travel-container">

        <a href="{% url 'home' %}" class="back-link">
            ‚Üê Back to Home
        </a>

        <h1 class="travel-title">
            Travel Your Way
            <span class="tag-pill">{{ selected_tag|title }}</span>
        </h1>

        <p class="travel-subtitle">
            Showing treks and trips that match your travel style.
        </p>

    </div>
</section>

<!-- ================= TREKS ================= -->
<section class="trek-listing">
    <div class="container travel-container">
        <div class="row g-4">

            {% for trek in treks %}
            <div class="col-12 col-sm-6 col-md-4 col-lg-3 d-flex">

                <a href="{% url 'card_trek_detail' trek.id %}"
                   class="premium-card w-100 text-decoration-none text-dark d-flex flex-column">

                    <!-- IMAGE -->
                    <div class="trek-card-image-wrapper ratio ratio-4x3">
                        <div class="image-inner">

                            {% with trek.images.first as img %}
                                {% if img and img.image_url %}
                                    <img src="{{ img.image_url }}" alt="{{ trek.name }}" loading="lazy">
                                {% else %}
                                    <img src="{% static 'images/placeholder-trek.jpg' %}" alt="{{ trek.name }}">
                                {% endif %}
                            {% endwith %}

                            <!-- PRICE -->
                            <div class="price-pill">
                                <span class="price-onwards">Onwards*</span>
                                <span class="price-value">‚Çπ{{ trek.price_start }}</span>
                            </div>

                        </div>
                    </div>

                    <!-- CONTENT -->
                    <div class="card-content">

                        <h3 class="trek-title">{{ trek.name }}</h3>

                        <p class="location-text">
                            üìç {{ trek.state }}
                        </p>

                        <p class="days">
                            <strong>Duration:</strong> {{ trek.duration_days }}
                        </p>

                        <p class="days">
                            <strong>Departure:</strong> {{ trek.operating_days|upper }}
                        </p>

                        <!-- OPERATORS -->
                        {% if trek.operators.exists %}
                        <div class="operator-grid-wrapper">
                            {% for operator in trek.operators.all|slice:":3" %}
                                <span class="operator-badge-premium">{{ operator }}</span>
                            {% endfor %}
                            {% if trek.operators.count > 3 %}
                                <span class="operator-badge-premium">
                                    +{{ trek.operators.count|add:"-3" }}
                                </span>
                            {% endif %}
                        </div>
                        {% endif %}

                    </div>

                </a>

            </div>
            {% endfor %}

        </div>
    </div>
</section>

{% endblock %}

{% block extra_css %}
<style>

/* ================= LAYOUT ================= */
.travel-container {
    padding-left: clamp(0.75rem, 2vw, 1rem);
    padding-right: clamp(0.75rem, 2vw, 1rem);
}

/* ================= HEADER ================= */
.travel-header {
    padding-top: clamp(6rem, 15vw, 7.5rem);
    padding-bottom: clamp(2rem, 4vw, 3rem);
    background: #f8fafc;
    border-bottom: 1px solid #e5e7eb;
}

.back-link {
    display: inline-block;
    margin-bottom: 1rem;
    font-weight: 600;
    color: #2563eb;
    text-decoration: none;
}

.travel-title {
    font-size: clamp(2rem, 4vw, 3rem);
    font-weight: 800;
    color: #111827;
    display: flex;
    align-items: center;
    gap: 1rem;
    flex-wrap: wrap;
}

.tag-pill {
    background: linear-gradient(135deg, #ff7a18, #ff3d00);
    color: #fff;
    padding: 6px 16px;
    border-radius: 999px;
    font-size: 0.85rem;
    font-weight: 700;
}

.travel-subtitle {
    margin-top: 0.75rem;
    color: #4b5563;
    max-width: 640px;
}

/* ================= TREK LIST ================= */
.trek-listing {
    background: #f1f6f7;
    padding: 3.5rem 0 4.5rem;
}

/* ================= CARD ================= */
.premium-card {
    background: #ffffff;
    border-radius: 22px;
    border: 1px solid #e5e7eb;
    overflow: hidden;
    transition: transform .3s ease, box-shadow .3s ease;
}

.premium-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 20px 45px rgba(0,0,0,.12);
}

/* IMAGE */
.trek-card-image-wrapper {
    position: relative;
    overflow: hidden;
}

.image-inner {
    position: absolute;
    inset: 0;
}

.image-inner img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform .5s ease;
}

.premium-card:hover img {
    transform: scale(1.08);
}

/* PRICE */
.price-pill {
    position: absolute;
    bottom: 18px;
    right: 18px;
    background: #f97316;
    color: #fff;
    padding: 10px 18px;
    border-radius: 999px;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    box-shadow: 0 8px 20px rgba(0,0,0,.35);
}

.price-onwards {
    font-size: 0.65rem;
    font-weight: 600;
    letter-spacing: .08em;
    opacity: .9;
}

.price-value {
    font-size: 1.25rem;
    font-weight: 800;
    line-height: 1;
}

/* CONTENT */
.card-content {
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    flex-grow: 1;
}

.trek-title {
    font-size: 1.45rem;
    font-weight: 800;
    margin-bottom: 0.35rem;
    color: #111827;
}

.location-text {
    font-size: 1rem;
    font-weight: 600;
    color: #4b5563;
    margin-bottom: 0.6rem;
}

.days {
    font-size: 0.95rem;
    color: #374151;
    margin-bottom: 0.3rem;
}

/* OPERATORS */
.operator-grid-wrapper {
    margin-top: auto;
    padding-top: 1rem;
    border-top: 1px solid #e5e7eb;
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.operator-badge-premium {
    background: #f97316;
    color: #ffffff;
    font-size: 0.8rem;
    font-weight: 600;
    padding: 8px 18px;
    border-radius: 999px;
    white-space: nowrap;
}

/* ================= MOBILE ================= */
@media (max-width: 576px) {
    .trek-title {
        font-size: 1.25rem;
    }

    .card-content {
        padding: 1.25rem;
    }

    .price-pill {
        padding: 8px 16px;
    }
}

</style>
{% endblock %}
